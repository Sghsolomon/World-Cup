<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css"
    />

    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href="./world-cup.css" />
    <title>World Cup</title>
  </head>
  <body id="wc2022">
    <!--Header-->
    <header>
      <div id="header" class="col-12">
        <div class="row">
          <div class="col-12">
            <div id="emblem" class="">
              <img
                id="wcTrophy"
                class="rounded"
                src="images/WC-Qatar-emblem.png"
                alt="WORLD CUP TROPHY"
              />
            </div>
            <!-- <i class="h4 m-2 bi bi-trophy-fill"></i>
            <span id="wc-description"><h3>WORLD-CUP</h3></span>
            <span id="wc-year" class="d-none d-lg-inline m-2"></span> -->
          </div>
        </div>
        <div class="row">
          <div class="col-5">
            <button class="btn btn-success mt-3">
              <i class="bi bi-house-fill px-2"></i
              ><a href="main.html" class="link-dark h5" active>Home</a>
            </button>
          </div>
          <div class="col-7">
            <h1 class="">GROUP STAGE</h1>
          </div>
        </div>
      </div>
    </header>
    <!--Main-->
    <main id="main" class="container">
      <div id="table2022" class="col-12">
        <!--<table id="table2022" class="table table-striped ">
             <tr>
              <th scope="row">20 November 2022</th>
              <td></td>
              <td></td>
              <th>NS</th>
              <td></td>
              <td></td>
              <td></td>
            </tr> -->
        <!-- <tr>
              <td class="col-4">Jacob</td>
              <td class="col-1">solomon</td>
              <td class="col-1">vs</td>
              <td class="col-4">Jacob</td>
              <td class="col-1">Thornton</td>
              
            </tr>
            <tr>
              <th scope="row">3</th>
              <td>Larry</td>
              <td>the Bird</td>
              <td>@twitter</td>
              <td>@twitter</td>
            </tr>
            </tbody>
          </table>-->
      </div>
      <div class="popup" id="popup" class="container">
        <button id="x" type="button" onclick="closeDiv()">X</button>
        <div id="tableDiv" class="ms-5 ps-4"></div>
      </div>
    </main>

    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
      crossorigin="anonymous"
    ></script>
    <script>
      let elements = null;

      async function queryApi() {
        const yearDiv = document.querySelector('#wc-year');
        const emblemDiv = document.querySelector('#emblem');
        let myTable = document.querySelector('#table2022');
        let table = null;
        let image = document.createElement('img');
        image.style.width = 50 + 'px';
        image.style.height = 50 + 'px';

        const url =
          'https://api.football-data.org/v4/competitions/WC/matches/?season=2022';
        const options = {
          method: 'GET',
          headers: {
            'X-Auth-Token': '28cf1b7583664e37a813c8455327ed07',
          },
        };

        try {
          const res = await fetch(url, options);
          const data = await res.json();
          elements = data.matches;

          //console.log(elements);

          for (let element in elements) {
            image.src = elements[element].homeTeam['crest'];
            //console.log(element, elements[element]);
            divTable = document.createElement('div');
            divTable.className = `row mb-4`;

            divTable.id = element;

            table = `
              <table class= 'bg-white' border-collapse: separate;>
                <tr>
              <td></td>
              <td></td>
              <td class = 'table-primary text-center bg-success rounded'>${elements[
                element
              ].utcDate.slice(0, 10)}-(${elements[element].utcDate.slice(
              11,
              16
            )})</td>
              <td></td>
              <td></td>
              </tr >
                <tr>
               <td class="col-1"><img src= ${
                 elements[element].homeTeam['crest']
               } alt="" border=3 height=30 width=30></img></td>
               <td class="col-4 text-center">${
                 elements[element].homeTeam['name']
               }</td>
               <td onClick = "tdClick('${element}')" id='tdDetail' class="col-1 text-center bg-primary rounded">Details</td>
               <td class="col-4 text-center">${
                 elements[element].awayTeam['name']
               }</td>
               <td class="col-1"><img src= ${
                 elements[element].awayTeam['crest']
               } alt="team flag"  height=30 width=30></img></td>
               </tr>
               <tr>
              <td class="col-1"></td>
              <td class="col-4"></td>
              <td class = 'col-2 text-center  bg-warning rounded '>${
                elements[element].venue
              }</td>
              <td class="col-4"></td>
              <td class="col-1"></td>
              
              </tr>
                </table>
             `;

            divTable.innerHTML = table;
            myTable.appendChild(divTable);
          }
          //let year = document.createElement('h3');
          // year.textContent = data.filters.season;
          //yearDiv.appendChild(year);
          // let image = document.createElement('img');
          // image.style.width = 150 + 'px';
          // image.style.height = 100 + 'px';
          // image.src = data.competition.emblem;
          // image.classList = `bg-warning  rounded`;
          // emblemDiv.appendChild(image);
        } catch (error) {
          console.error(error.message);
        }
      }

      function tdClick(data) {
        console.log('start');
        //console.log(elements[data]);
        const object = elements[data];
        console.log(object);
        let popup = document.querySelector('.popup');
        popup.classList.add('open-popup');
        let tableDiv = document.querySelector('#tableDiv');

        let = table = `
        <table class= 'bg-white' border-collapse: separate;>
          <tbody>
        <tr >
          <td border-spacing: 10px;><img src= ${object.awayTeam['crest']} alt="team flag"  height=60 width=60></img></td>
          <td border-spacing: 10px; >${object.awayTeam['name']}</td>
          <td >${object.score.fullTime['away']}</td>
          </tr>
         <tr >
          <td><img src= ${object.homeTeam['crest']} alt="team flag"  height=60 width=60></img></td>
          <td>${object.homeTeam['name']}</td>
          <td>${object.score.fullTime['home']}</td>
          </tr>
          </tbody>
          </table>
          `;
        tableDiv.innerHTML = table;
        popup.appendChild(tableDiv);

        console.log('finish');
      }

      function closeDiv() {
        let tableDiv = document.querySelector('#tableDiv');
        let popup = document.querySelector('.popup');
        console.log(popup);
        while (tableDiv.firstChild) tableDiv.removeChild(tableDiv.firstChild);
        popup.classList.remove('open-popup');
      }

      queryApi();
    </script>
  </body>
</html>
